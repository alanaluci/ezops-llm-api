# ðŸ”¹ Usar Python 3.12 slim como base
FROM python:3.12-slim

# ðŸ”¹ Definir diretÃ³rio de trabalho
WORKDIR /app

# ðŸ”¹ Instalar dependÃªncias do sistema necessÃ¡rias
RUN apt-get update && apt-get install -y \
    build-essential \
    python3-dev \
    gcc \
    curl \
    && rm -rf /var/lib/apt/lists/*

# ðŸ”¹ Atualizar pip e instalar pacotes essenciais
RUN pip install --no-cache-dir --upgrade pip setuptools wheel

# ðŸ”¹ Instalar spaCy e dependÃªncias necessÃ¡rias
RUN pip install --no-cache-dir \
    "blis==0.7.9" \
    "thinc>=8.2.2,<8.3.0" \
    "spacy==3.7.5"

# ðŸ”¹ Baixar e instalar o modelo do spaCy manualmente
RUN python -m spacy download pt_core_news_sm

# ðŸ”¹ Copiar os arquivos do projeto para dentro do container
COPY . /app

# ðŸ”¹ Instalar dependÃªncias do projeto (FastAPI, Uvicorn, etc.)
RUN pip install --no-cache-dir -r requirements.txt

# ðŸ”¹ Expor a porta 8000 para o servidor FastAPI
EXPOSE 8000

# ðŸ”¹ Comando para rodar a API com Uvicorn
CMD ["uvicorn", "main:app", "--host", "0.0.0.0", "--port", "8000"]
